import i18n from 'i18next';

// Translation resources
const resources = {
  en: {
    translation: {
      // Popup
      popup: {
        loading: 'Loading...',
        tagline: 'AI-Powered Review Replies',
        email: 'Email',
        emailPlaceholder: 'you@example.com',
        password: 'Password',
        passwordPlaceholder: '••••••••',
        signingIn: 'Signing in...',
        signIn: 'Sign In',
        noAccount: "Don't have an account?",
        signUpFree: 'Sign up free',
        logout: 'Logout',
        repliesRemaining: 'Replies remaining',
        resetsMonthly: 'Resets monthly',
        goToReviews: 'Go to your reviews',
        more: 'more',
        andMore: 'And many more platforms...',
        upgradeUnlimited: 'Upgrade for unlimited replies →',
        tabs: {
          dashboard: 'Dashboard',
          reply: 'Reply',
        },
        reply: {
          pasteReview: 'Paste the review',
          pasteReviewPlaceholder: 'Paste the customer review here...',
          rating: 'Review rating',
          length: 'Response length',
          short: 'Short',
          medium: 'Medium',
          detailed: 'Detailed',
          customInstructions: 'Custom instructions (optional)',
          customInstructionsPlaceholder: 'Additional instructions...',
          generate: 'Generate reply',
          generating: 'Generating...',
          generatedReply: 'Generated reply',
          copy: 'Copy',
          copied: '✓ Copied',
          regenerate: 'Regenerate',
          errorEmpty: 'Please paste a review first',
        },
        style: {
          title: 'Personalize your replies',
          description: 'Set the tone and style of your AI responses',
          configure: 'Configure',
          modify: 'Modify response style',
        },
        footer: {
          upgrade: 'Go unlimited',
        },
      },
      // Content scripts modal
      modal: {
        title: 'Generate AI Reply',
        responseLength: 'Response length',
        short: 'Short',
        medium: 'Medium',
        detailed: 'Detailed',
        customPrompt: 'Custom instructions (optional)',
        customPromptPlaceholder: 'Additional instructions for this response...',
        generate: 'Generate reply',
        generating: 'Generating...',
        generatedReply: 'Generated reply',
        regenerate: 'Regenerate',
        copy: 'Copy',
        copied: '✓ Copied',
        insert: 'Insert',
        loginRequired: 'Login required',
        loginDescription: 'Sign in to your ReplyStack account to generate AI replies.',
        loginButton: 'Sign in',
        aiReplyButton: '✨ AI Reply',
        // Registration
        registerTitle: 'Create your account',
        registerDescription: 'Sign up to start generating AI replies for free.',
        namePlaceholder: 'Your name (optional)',
        confirmPasswordPlaceholder: 'Confirm password',
        registerButton: 'Create account',
        registering: 'Creating account...',
        hasAccount: 'Already have an account?',
        signInLink: 'Sign in',
      },
      // Errors
      errors: {
        loginFailed: 'Login failed',
        noResponse: 'No response from extension',
        generateFailed: 'Failed to generate reply',
        invalidCredentials: 'Invalid email or password',
        tooManyAttempts: 'Too many attempts. Please try again later.',
        networkError: 'Network error. Please check your connection.',
        signInRequired: 'Please sign in to generate replies.',
        signInRequiredAction: 'Click on the ReplyStack icon in your browser toolbar to sign in.',
        quotaExceeded: "You've reached your quota limit. Please upgrade your plan for more replies.",
        rateLimited: 'Too many requests. Please wait a moment before trying again.',
        emailInUse: 'This email is already registered.',
        passwordTooWeak: 'Password must be at least 8 characters with uppercase, lowercase, and numbers.',
        passwordMismatch: 'Passwords do not match.',
        registrationFailed: 'Registration failed. Please try again.',
      },
      // Quota exhausted state
      quotaExhausted: {
        title: 'Monthly limit reached',
        description: 'You have used all your monthly replies. Upgrade to continue generating AI replies.',
        upgradeButton: 'Upgrade now',
      },
    },
  },
  fr: {
    translation: {
      popup: {
        loading: 'Chargement...',
        tagline: 'Réponses IA aux avis clients',
        email: 'Email',
        emailPlaceholder: 'vous@exemple.com',
        password: 'Mot de passe',
        passwordPlaceholder: '••••••••',
        signingIn: 'Connexion...',
        signIn: 'Se connecter',
        noAccount: "Pas encore de compte ?",
        signUpFree: "S'inscrire gratuitement",
        logout: 'Déconnexion',
        repliesRemaining: 'Réponses restantes',
        resetsMonthly: 'Réinitialisation mensuelle',
        goToReviews: 'Accéder à vos avis',
        more: 'plus',
        andMore: 'Et bien d\'autres plateformes...',
        upgradeUnlimited: 'Passez au illimité →',
        tabs: {
          dashboard: 'Dashboard',
          reply: 'Répondre',
        },
        reply: {
          pasteReview: 'Coller l\'avis',
          pasteReviewPlaceholder: 'Collez l\'avis client ici...',
          rating: 'Note de l\'avis',
          length: 'Longueur de la réponse',
          short: 'Courte',
          medium: 'Moyenne',
          detailed: 'Longue',
          customInstructions: 'Instructions personnalisées (optionnel)',
          customInstructionsPlaceholder: 'Instructions supplémentaires...',
          generate: 'Générer la réponse',
          generating: 'Génération...',
          generatedReply: 'Réponse générée',
          copy: 'Copier',
          copied: '✓ Copié',
          regenerate: 'Régénérer',
          errorEmpty: 'Veuillez d\'abord coller un avis',
        },
        style: {
          title: 'Personnalisez vos réponses',
          description: 'Définissez le ton et le style de vos réponses IA',
          configure: 'Configurer',
          modify: 'Modifier le style de réponse',
        },
        footer: {
          upgrade: 'Passer illimité',
        },
      },
      modal: {
        title: 'Générer une réponse IA',
        responseLength: 'Longueur de la réponse',
        short: 'Courte',
        medium: 'Moyenne',
        detailed: 'Longue',
        customPrompt: 'Instructions personnalisées (optionnel)',
        customPromptPlaceholder: 'Instructions supplémentaires pour cette réponse...',
        generate: 'Générer la réponse',
        generating: 'Génération...',
        generatedReply: 'Réponse générée',
        regenerate: 'Régénérer',
        copy: 'Copier',
        copied: '✓ Copié',
        insert: 'Insérer',
        loginRequired: 'Connexion requise',
        loginDescription: 'Connectez-vous à votre compte ReplyStack pour générer des réponses IA.',
        loginButton: 'Se connecter',
        aiReplyButton: '✨ Réponse IA',
        registerTitle: 'Créer votre compte',
        registerDescription: 'Inscrivez-vous pour commencer à générer des réponses IA gratuitement.',
        namePlaceholder: 'Votre nom (optionnel)',
        confirmPasswordPlaceholder: 'Confirmer le mot de passe',
        registerButton: 'Créer un compte',
        registering: 'Création du compte...',
        hasAccount: 'Déjà un compte ?',
        signInLink: 'Se connecter',
      },
      errors: {
        loginFailed: 'Échec de la connexion',
        noResponse: 'Pas de réponse de l\'extension',
        generateFailed: 'Impossible de générer la réponse',
        invalidCredentials: 'Email ou mot de passe incorrect',
        tooManyAttempts: 'Trop de tentatives. Veuillez réessayer plus tard.',
        networkError: 'Erreur réseau. Vérifiez votre connexion.',
        signInRequired: 'Veuillez vous connecter pour générer des réponses.',
        signInRequiredAction: 'Cliquez sur l\'icône ReplyStack dans la barre d\'outils de votre navigateur pour vous connecter.',
        quotaExceeded: 'Vous avez atteint votre limite de quota. Passez à un plan supérieur pour plus de réponses.',
        rateLimited: 'Trop de requêtes. Veuillez patienter un moment avant de réessayer.',
        emailInUse: 'Cette adresse email est déjà utilisée.',
        passwordTooWeak: 'Le mot de passe doit contenir au moins 8 caractères avec majuscules, minuscules et chiffres.',
        passwordMismatch: 'Les mots de passe ne correspondent pas.',
        registrationFailed: 'Échec de l\'inscription. Veuillez réessayer.',
      },
      quotaExhausted: {
        title: 'Limite mensuelle atteinte',
        description: 'Vous avez utilisé toutes vos réponses mensuelles. Passez à un plan supérieur pour continuer.',
        upgradeButton: 'Passer au plan supérieur',
      },
    },
  },
  es: {
    translation: {
      popup: {
        loading: 'Cargando...',
        tagline: 'Respuestas IA a reseñas',
        email: 'Email',
        emailPlaceholder: 'tu@ejemplo.com',
        password: 'Contraseña',
        passwordPlaceholder: '••••••••',
        signingIn: 'Iniciando sesión...',
        signIn: 'Iniciar sesión',
        noAccount: '¿No tienes cuenta?',
        signUpFree: 'Regístrate gratis',
        logout: 'Cerrar sesión',
        repliesRemaining: 'Respuestas restantes',
        resetsMonthly: 'Se reinicia mensualmente',
        goToReviews: 'Ir a tus reseñas',
        more: 'más',
        andMore: 'Y muchas más plataformas...',
        upgradeUnlimited: 'Actualiza para respuestas ilimitadas →',
        tabs: {
          dashboard: 'Panel',
          reply: 'Responder',
        },
        reply: {
          pasteReview: 'Pegar la reseña',
          pasteReviewPlaceholder: 'Pega la reseña del cliente aquí...',
          rating: 'Calificación de la reseña',
          length: 'Longitud de la respuesta',
          short: 'Corta',
          medium: 'Media',
          detailed: 'Detallada',
          customInstructions: 'Instrucciones personalizadas (opcional)',
          customInstructionsPlaceholder: 'Instrucciones adicionales...',
          generate: 'Generar respuesta',
          generating: 'Generando...',
          generatedReply: 'Respuesta generada',
          copy: 'Copiar',
          copied: '✓ Copiado',
          regenerate: 'Regenerar',
          errorEmpty: 'Por favor, pega una reseña primero',
        },
        style: {
          title: 'Personaliza tus respuestas',
          description: 'Define el tono y estilo de tus respuestas IA',
          configure: 'Configurar',
          modify: 'Modificar estilo de respuesta',
        },
        footer: {
          upgrade: 'Pasar a ilimitado',
        },
      },
      modal: {
        title: 'Generar respuesta IA',
        responseLength: 'Longitud de respuesta',
        short: 'Corta',
        medium: 'Media',
        detailed: 'Detallada',
        customPrompt: 'Instrucciones personalizadas (opcional)',
        customPromptPlaceholder: 'Instrucciones adicionales para esta respuesta...',
        generate: 'Generar respuesta',
        generating: 'Generando...',
        generatedReply: 'Respuesta generada',
        regenerate: 'Regenerar',
        copy: 'Copiar',
        copied: '✓ Copiado',
        insert: 'Insertar',
        loginRequired: 'Inicio de sesión requerido',
        loginDescription: 'Inicia sesión en tu cuenta ReplyStack para generar respuestas IA.',
        loginButton: 'Iniciar sesión',
        aiReplyButton: '✨ Respuesta IA',
        registerTitle: 'Crea tu cuenta',
        registerDescription: 'Regístrate para empezar a generar respuestas IA gratis.',
        namePlaceholder: 'Tu nombre (opcional)',
        confirmPasswordPlaceholder: 'Confirmar contraseña',
        registerButton: 'Crear cuenta',
        registering: 'Creando cuenta...',
        hasAccount: '¿Ya tienes cuenta?',
        signInLink: 'Iniciar sesión',
      },
      errors: {
        loginFailed: 'Error de inicio de sesión',
        noResponse: 'Sin respuesta de la extensión',
        generateFailed: 'Error al generar respuesta',
        invalidCredentials: 'Email o contraseña incorrectos',
        tooManyAttempts: 'Demasiados intentos. Inténtelo más tarde.',
        networkError: 'Error de red. Verifique su conexión.',
        signInRequired: 'Por favor, inicia sesión para generar respuestas.',
        signInRequiredAction: 'Haz clic en el icono de ReplyStack en la barra de herramientas de tu navegador para iniciar sesión.',
        quotaExceeded: 'Has alcanzado tu límite de cuota. Por favor, actualiza tu plan para más respuestas.',
        rateLimited: 'Demasiadas solicitudes. Espera un momento antes de intentar de nuevo.',
        emailInUse: 'Este email ya está registrado.',
        passwordTooWeak: 'La contraseña debe tener al menos 8 caracteres con mayúsculas, minúsculas y números.',
        passwordMismatch: 'Las contraseñas no coinciden.',
        registrationFailed: 'Error en el registro. Inténtalo de nuevo.',
      },
      quotaExhausted: {
        title: 'Límite mensual alcanzado',
        description: 'Has usado todas tus respuestas mensuales. Actualiza tu plan para continuar.',
        upgradeButton: 'Actualizar plan',
      },
    },
  },
  it: {
    translation: {
      popup: {
        loading: 'Caricamento...',
        tagline: 'Risposte IA alle recensioni',
        email: 'Email',
        emailPlaceholder: 'tu@esempio.com',
        password: 'Password',
        passwordPlaceholder: '••••••••',
        signingIn: 'Accesso in corso...',
        signIn: 'Accedi',
        noAccount: 'Non hai un account?',
        signUpFree: 'Registrati gratis',
        logout: 'Esci',
        repliesRemaining: 'Risposte rimanenti',
        resetsMonthly: 'Si resetta mensilmente',
        goToReviews: 'Vai alle tue recensioni',
        more: 'altro',
        andMore: 'E molte altre piattaforme...',
        upgradeUnlimited: 'Aggiorna per risposte illimitate →',
        tabs: {
          dashboard: 'Dashboard',
          reply: 'Rispondi',
        },
        reply: {
          pasteReview: 'Incolla la recensione',
          pasteReviewPlaceholder: 'Incolla la recensione del cliente qui...',
          rating: 'Valutazione della recensione',
          length: 'Lunghezza della risposta',
          short: 'Breve',
          medium: 'Media',
          detailed: 'Dettagliata',
          customInstructions: 'Istruzioni personalizzate (opzionale)',
          customInstructionsPlaceholder: 'Istruzioni aggiuntive...',
          generate: 'Genera risposta',
          generating: 'Generazione...',
          generatedReply: 'Risposta generata',
          copy: 'Copia',
          copied: '✓ Copiato',
          regenerate: 'Rigenera',
          errorEmpty: 'Per favore, incolla prima una recensione',
        },
        style: {
          title: 'Personalizza le tue risposte',
          description: 'Definisci il tono e lo stile delle tue risposte IA',
          configure: 'Configura',
          modify: 'Modifica stile risposta',
        },
        footer: {
          upgrade: 'Passa a illimitato',
        },
      },
      modal: {
        title: 'Genera risposta IA',
        responseLength: 'Lunghezza risposta',
        short: 'Breve',
        medium: 'Media',
        detailed: 'Dettagliata',
        customPrompt: 'Istruzioni personalizzate (opzionale)',
        customPromptPlaceholder: 'Istruzioni aggiuntive per questa risposta...',
        generate: 'Genera risposta',
        generating: 'Generazione...',
        generatedReply: 'Risposta generata',
        regenerate: 'Rigenera',
        copy: 'Copia',
        copied: '✓ Copiato',
        insert: 'Inserisci',
        loginRequired: 'Accesso richiesto',
        loginDescription: 'Accedi al tuo account ReplyStack per generare risposte IA.',
        loginButton: 'Accedi',
        aiReplyButton: '✨ Risposta IA',
        registerTitle: 'Crea il tuo account',
        registerDescription: 'Registrati per iniziare a generare risposte IA gratuitamente.',
        namePlaceholder: 'Il tuo nome (opzionale)',
        confirmPasswordPlaceholder: 'Conferma password',
        registerButton: 'Crea account',
        registering: 'Creazione account...',
        hasAccount: 'Hai già un account?',
        signInLink: 'Accedi',
      },
      errors: {
        loginFailed: 'Accesso fallito',
        noResponse: "Nessuna risposta dall'estensione",
        generateFailed: 'Impossibile generare la risposta',
        invalidCredentials: 'Email o password non validi',
        tooManyAttempts: 'Troppi tentativi. Riprova più tardi.',
        networkError: 'Errore di rete. Verifica la connessione.',
        signInRequired: 'Accedi per generare risposte.',
        signInRequiredAction: 'Clicca sull\'icona ReplyStack nella barra degli strumenti del browser per accedere.',
        quotaExceeded: 'Hai raggiunto il limite di quota. Aggiorna il tuo piano per più risposte.',
        rateLimited: 'Troppe richieste. Attendi un momento prima di riprovare.',
        emailInUse: 'Questa email è già registrata.',
        passwordTooWeak: 'La password deve contenere almeno 8 caratteri con maiuscole, minuscole e numeri.',
        passwordMismatch: 'Le password non corrispondono.',
        registrationFailed: 'Registrazione fallita. Riprova.',
      },
      quotaExhausted: {
        title: 'Limite mensile raggiunto',
        description: 'Hai utilizzato tutte le tue risposte mensili. Aggiorna il piano per continuare.',
        upgradeButton: 'Aggiorna piano',
      },
    },
  },
  pt: {
    translation: {
      popup: {
        loading: 'Carregando...',
        tagline: 'Respostas IA para avaliações',
        email: 'Email',
        emailPlaceholder: 'voce@exemplo.com',
        password: 'Senha',
        passwordPlaceholder: '••••••••',
        signingIn: 'Entrando...',
        signIn: 'Entrar',
        noAccount: 'Não tem uma conta?',
        signUpFree: 'Cadastre-se grátis',
        logout: 'Sair',
        repliesRemaining: 'Respostas restantes',
        resetsMonthly: 'Reseta mensalmente',
        goToReviews: 'Ir para suas avaliações',
        more: 'mais',
        andMore: 'E muitas outras plataformas...',
        upgradeUnlimited: 'Atualize para respostas ilimitadas →',
        tabs: {
          dashboard: 'Painel',
          reply: 'Responder',
        },
        reply: {
          pasteReview: 'Colar a avaliação',
          pasteReviewPlaceholder: 'Cole a avaliação do cliente aqui...',
          rating: 'Nota da avaliação',
          length: 'Tamanho da resposta',
          short: 'Curta',
          medium: 'Média',
          detailed: 'Detalhada',
          customInstructions: 'Instruções personalizadas (opcional)',
          customInstructionsPlaceholder: 'Instruções adicionais...',
          generate: 'Gerar resposta',
          generating: 'Gerando...',
          generatedReply: 'Resposta gerada',
          copy: 'Copiar',
          copied: '✓ Copiado',
          regenerate: 'Regenerar',
          errorEmpty: 'Por favor, cole uma avaliação primeiro',
        },
        style: {
          title: 'Personalize suas respostas',
          description: 'Defina o tom e estilo das suas respostas IA',
          configure: 'Configurar',
          modify: 'Modificar estilo de resposta',
        },
        footer: {
          upgrade: 'Passar para ilimitado',
        },
      },
      modal: {
        title: 'Gerar resposta IA',
        responseLength: 'Tamanho da resposta',
        short: 'Curta',
        medium: 'Média',
        detailed: 'Detalhada',
        customPrompt: 'Instruções personalizadas (opcional)',
        customPromptPlaceholder: 'Instruções adicionais para esta resposta...',
        generate: 'Gerar resposta',
        generating: 'Gerando...',
        generatedReply: 'Resposta gerada',
        regenerate: 'Regenerar',
        copy: 'Copiar',
        copied: '✓ Copiado',
        insert: 'Inserir',
        loginRequired: 'Login necessário',
        loginDescription: 'Entre na sua conta ReplyStack para gerar respostas IA.',
        loginButton: 'Entrar',
        aiReplyButton: '✨ Resposta IA',
        registerTitle: 'Crie sua conta',
        registerDescription: 'Cadastre-se para começar a gerar respostas IA gratuitamente.',
        namePlaceholder: 'Seu nome (opcional)',
        confirmPasswordPlaceholder: 'Confirmar senha',
        registerButton: 'Criar conta',
        registering: 'Criando conta...',
        hasAccount: 'Já tem uma conta?',
        signInLink: 'Entrar',
      },
      errors: {
        loginFailed: 'Falha no login',
        noResponse: 'Sem resposta da extensão',
        generateFailed: 'Falha ao gerar resposta',
        invalidCredentials: 'Email ou senha inválidos',
        tooManyAttempts: 'Muitas tentativas. Tente novamente mais tarde.',
        networkError: 'Erro de rede. Verifique sua conexão.',
        signInRequired: 'Por favor, faça login para gerar respostas.',
        signInRequiredAction: 'Clique no ícone do ReplyStack na barra de ferramentas do navegador para entrar.',
        quotaExceeded: 'Você atingiu seu limite de cota. Atualize seu plano para mais respostas.',
        rateLimited: 'Muitas solicitações. Aguarde um momento antes de tentar novamente.',
        emailInUse: 'Este email já está cadastrado.',
        passwordTooWeak: 'A senha deve ter pelo menos 8 caracteres com maiúsculas, minúsculas e números.',
        passwordMismatch: 'As senhas não coincidem.',
        registrationFailed: 'Falha no cadastro. Tente novamente.',
      },
      quotaExhausted: {
        title: 'Limite mensal atingido',
        description: 'Você usou todas as suas respostas mensais. Atualize seu plano para continuar.',
        upgradeButton: 'Atualizar plano',
      },
    },
  },
};

// Map API error messages to translation keys
const errorMap: Record<string, string> = {
  'These credentials do not match our records.': 'errors.invalidCredentials',
  'Too Many Attempts.': 'errors.tooManyAttempts',
  'The provided credentials are incorrect.': 'errors.invalidCredentials',
  'QUOTA_EXCEEDED': 'errors.quotaExceeded',
  'RATE_LIMITED': 'errors.rateLimited',
  'Cette adresse email est déjà utilisée.': 'errors.emailInUse',
  'This email is already registered.': 'errors.emailInUse',
  'The email has already been taken.': 'errors.emailInUse',
  'La confirmation du mot de passe ne correspond pas.': 'errors.passwordMismatch',
  'The password field confirmation does not match.': 'errors.passwordMismatch',
  'The password confirmation does not match.': 'errors.passwordMismatch',
};

/**
 * Translate an API error message to the current language.
 */
export const translateError = (message: string): string => {
  const key = errorMap[message];
  if (key) {
    return i18n.t(key);
  }
  // Check if it's a network error
  if (message.toLowerCase().includes('network') || message.toLowerCase().includes('fetch')) {
    return i18n.t('errors.networkError');
  }
  return message;
};

// Initialize i18next
i18n.init({
  resources,
  lng: navigator.language.split('-')[0], // Detect browser language
  fallbackLng: 'en',
  interpolation: {
    escapeValue: false,
  },
});

// Export the t function for use in content scripts
export const t = (key: string): string => {
  return i18n.t(key);
};

// Export i18n instance for React components
export default i18n;
