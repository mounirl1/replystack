# Railway configuration for ReplyStack monorepo
# This file tells Railway to deploy from the apps/api directory

[build]
# Use apps/api as the root directory for builds
builder = "nixpacks"
buildCommand = "cd apps/api && composer install --no-dev --optimize-autoloader && php artisan config:cache && php artisan route:cache && php artisan view:cache"

[deploy]
# Start command for the Laravel API
startCommand = "cd apps/api && php artisan migrate --force && php artisan serve --host=0.0.0.0 --port=${PORT:-8000}"
healthcheckPath = "/api"
healthcheckTimeout = 300
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
